(сервер 1 практики) ssh-keygen
eltex-pg1-v3@eltex-2025-summer-10:37> cat ~/.ssh/*.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDaFczXXSpQmi7HvmyftrqzRiuaQaNGYAXjfDbSRMh28i1uBZb5FmjLrFpb+Rv5jeluexG7VsxSKCznqrnTOgEvKYGDQ76w6VyR5S4e1V/8GNv6+kcOZRPYoFzdh71XndhyRuruWaxO+jwYGmITP8zPx4bZAqYiQmAoRJExAMcMBP6RJonM57z96AB9l47/Ibx3AA4MP8W5/wvOLRbGwZqMyUwncw17SVHnIpohpIy5SHQ9r/1W2y6V4SO2NatQtoHAGnwHI+3/E4ikByRgtkG8b6LOdtfaDuvLNHt3t3qm45lfYeDxfPUk7DBOwUAPuNBS8REPQNbaMO9baoqinPDtwpeMQWIfVFioWTRK8mYG9KxmFodZA3YYUcIMCroyxgXreeJrBGyzTsyqaWp1FlOYrX0IZC2LcyoMMLxYe6s7EJ8hs8PornXo4cApNadR3pk0sFLw5Svatko7EaIqxk3fzQHxYXfbAHCeJN7WGu++hed6BQ29pM3P7/VVNASqvkM= eltex-pg1-v3@eltex-2025-summer
eltex-pg1-v3@eltex-2025-summer-10:39> ls -l ~/.ssh/*.pub
-rw-r--r-- 1 eltex-pg1-v3 eltex-pg1-v3 584 июл 11 10:14 /home/eltex-pg1-v3/.ssh/id_rsa.pub
(сервер 2 практики) 
cat ~/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDaFczXXSpQmi7HvmyftrqzRiuaQaNGYAXjfDbSRMh28i1uBZb5FmjLrFpb+Rv5jeluexG7VsxSKCznqrnTOgEvKYGDQ76w6VyR5S4e1V/8GNv6+kcOZRPYoFzdh71XndhyRuruWaxO+jwYGmITP8zPx4bZAqYiQmAoRJExAMcMBP6RJonM57z96AB9l47/Ibx3AA4MP8W5/wvOLRbGwZqMyUwncw17SVHnIpohpIy5SHQ9r/1W2y6V4SO2NatQtoHAGnwHI+3/E4ikByRgtkG8b6LOdtfaDuvLNHt3t3qm45lfYeDxfPUk7DBOwUAPuNBS8REPQNbaMO9baoqinPDtwpeMQWIfVFioWTRK8mYG9KxmFodZA3YYUcIMCroyxgXreeJrBGyzTsyqaWp1FlOYrX0IZC2LcyoMMLxYe6s7EJ8hs8PornXo4cApNadR3pk0sFLw5Svatko7EaIqxk3fzQHxYXfbAHCeJN7WGu++hed6BQ29pM3P7/VVNASqvkM= eltex-pg1-v3@eltex-2025-summer
ls -l .ssh/authorized_keys
-rw------- 1 root root 584 Jul 11 03:33 .ssh/authorized_keys
useradd user1 -m -s /bin/bash
passwd user1
adduser user2
adduser user3
usermod -s /usr/sbin/nologin user3
su -l user3
This account is currently not available.
su -s /bin/bash -l user3
logout
groupadd newgroup
usermod -aG newgroup user1
usermod -aG newgroup user2
usermod -aG newgroup user3
groups user1
user1 : user1 newgroup
groups user2
user2 : user2 users newgroup
groups user3
user3 : user3 users newgroup
mkdir -p /opt/share
chown :newgroup /opt/share
chmod g+srwx /opt/share
ls -l /opt
total 4
drwxrwsr-x 2 root newgroup 4096 Jul 11 04:26 share
echo "umask 0004" > ~user1/.bashrc
su -l user1
touch /opt/share/user1file
touch /opt/share/user1file2
touch /opt/share/user1file3
su -l user2
touch /opt/share/user2file
touch /opt/share/user2file2
touch /opt/share/user2file3
su -s /bin/bash -l user3
touch /opt/share/user3file
touch /opt/share/user3file2
touch /opt/share/user3file3
ls -l /opt/share
total 0
-rw-rw--w- 1 user1 newgroup 0 Jul 11 04:41 user1file
-rw-rw--w- 1 user1 newgroup 0 Jul 11 04:41 user1file2
-rw-rw--w- 1 user1 newgroup 0 Jul 11 04:41 user1file3
-rw-rw-r-- 1 user2 newgroup 0 Jul 11 04:42 user2file
-rw-rw-r-- 1 user2 newgroup 0 Jul 11 04:42 user2file2
-rw-rw-r-- 1 user2 newgroup 0 Jul 11 04:42 user2file3
-rw-rw-r-- 1 user3 newgroup 0 Jul 11 04:43 user3file
-rw-rw-r-- 1 user3 newgroup 0 Jul 11 04:43 user3file2
-rw-rw-r-- 1 user3 newgroup 0 Jul 11 04:43 user3file3
su -l user1
rm /opt/share/user2file
rm /opt/share/user3file
logout
su -l user2
rm /opt/share/user1file2
rm /opt/share/user3file2
logout
su -s /bin/bash -l user3
rm /opt/share/user1file3
rm /opt/share/user2file3
logout
ls -l /opt/share
total 0
-rw-rw--w- 1 user1 newgroup 0 Jul 11 04:41 user1file
-rw-rw-r-- 1 user2 newgroup 0 Jul 11 04:42 user2file2
-rw-rw-r-- 1 user3 newgroup 0 Jul 11 04:43 user3file3
chmod +t /opt/share
ls -l /opt
total 4
drwxrwsr-t 2 root newgroup 4096 Jul 11 04:52 share
su -l user1
rm /opt/share/user3file3
rm: cannot remove '/opt/share/user3file3': Operation not permitted
logout
su -l user2
rm /opt/share/user1file
rm: cannot remove '/opt/share/user1file': Operation not permitted
su -s /bin/bash -l user3
rm /opt/share/user2file2
rm: cannot remove '/opt/share/user2file2': Operation not permitted
logout
echo "user1 ALL=(root) NOPASSWD: /usr/bin/dmesg" >> /etc/sudoers.d/dmesg_user1
sudo -u user1 sudo dmesg
[    0.000000] Linux version 6.8.0-55-generic (buildd@lcy02-amd64-095) (x86_64-linux-gnu-gcc-13 (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0, GNU ld (GNU Binutils for Ubuntu) 2.42) #57-Ubuntu SMP PREEMPT_DYNAMIC Wed Feb 12 23:42:21 UTC 2025 (Ubuntu 6.8.0-55.57-generic 6.8.12)
[    0.000000] Command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
[    0.000000] KERNEL supported cpus:
[    0.000000]   Intel GenuineIntel
[    0.000000]   AMD AuthenticAMD
...
[   34.297102] audit: type=1400 audit(1752200474.121:123): apparmor="STATUS" operation="profile_replace" profile="unconfined" name="/usr/lib/snapd/snap-confine//mount-namespace-capture-helper" pid=834 comm="apparmor_parser"
[   36.170658] NET: Registered PF_QIPCRTR protocol family
sudo nano /usr/local/bin/dmesgscr
cat /usr/local/bin/dmesgscr
#!/bin/bash
if [ "$(whoami)" != "user2" ]; then
    exit 1
fi
/usr/bin/dmesg
chown user2 /usr/local/bin/dmesgscr
chmod 4755 /usr/local/bin/dmesgscr
su -l user2
ls -l /usr/local/bin/dmesgscr
-rwsr-xr-x 1 user2 root 78 Jul 11 05:22 /usr/local/bin/dmesgscr
su -l user2
/usr/local/bin/dmesgscr
dmesg: read kernel buffer failed: Operation not permitted
logout
chage -M 10 user1
chage -M 10 user2
chage -M 10 user3
echo "Гомзякова Софья" >> /etc/motd
rsync -a /etc /root/etc_backup
tar -czf etc_backup.tar.gz /root/etc_backup/
tar -cjf etc_backup.tar.bz2 /root/etc_backup/
tar -cJf etc_backup.tar.xz /root/etc_backup/
du -h /root/etc_backup.* | sort -h
472K	/root/etc_backup.tar.xz
556K	/root/etc_backup.tar.bz2
584K	/root/etc_backup.tar.gz
date >> /etc/motd
rsync -a /etc /root/etc_backup
tar -czf etc_backup.tar.gz /root/etc_backup/
tar -tf /root/etc_backup.tar.bz2 | sort > /tmp/bz2_content
find /root/etc_backup | sed 's|/root|root|'  | sort > /tmp/orig_content
diff -y --suppress-common-lines /tmp/orig_content /tmp/bz2_content | wc -l
243
mkdir -p /root/etc_backup_{gzip,7zip}
tar -xzf etc_backup.tar.gz -C /root/etc_backup_gzip
tar -xJf etc_backup.tar.xz -C /root/etc_backup_7zip
diff etc_backup_gzip/root/etc_backup/etc/motd etc_backup_7zip/root/etc_backup/etc/motd
2d1
< Mon Jul 14 08:05:49 AM UTC 2025
